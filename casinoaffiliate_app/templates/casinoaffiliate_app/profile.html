{% extends 'casinoaffiliate_app/base.html' %} 

{% block header %}
<!-- header -->
<header class="flex sticky top-0 z-50 bg-[#0b0f1a] backdrop-blur-md justify-center">
    {% include 'casinoaffiliate_app/parts/header.html' %}
</header>
{% endblock %}
{% block content %}


<main class="min-h-screen py-8 bg-zinc-900">
    <div class="flex flex-col w-full md:w-6/12 m-auto">
        <ul id="default-tab" class="flex flex-col md:flex-row gap-y-8 gap-x-8 mb-8" data-tabs-toggle="#default-tab-content" role="tablist"
            data-tabs-active-classes="">
            <li id="profile-tab" data-tabs-target="#profile" type="button" role="tab" aria-controls="profile" class="relative p-4 bg-center bg-cover bg-[url('https://tailwindcss.com/_next/static/media/docs@tinypng.d9e4dcdc.png')] 
                rounded-xl flex flex-col gap-y-2 basis-1/3">
                <div
                    class="absolute bottom-0 left-0 right-0 top-0 h-full w-full overflow-hidden bg-fixed bg-amber-200 bg-opacity-[0.1] rounded-xl">
                </div>
                <p class="font-semibold text-zinc-100 text-2xl z-10">Bakiye</p>
                <p class="font-medium text-lg text-white z-10">{{balance}}</p>
            </li>
            <li id="deposit-tab" data-tabs-target="#deposit" type="button" role="tab" aria-controls="deposit" class="relative p-4 bg-center bg-cover bg-[url('https://tailwindcss.com/_next/static/media/docs@tinypng.d9e4dcdc.png')] 
                rounded-xl flex flex-col gap-y-2 basis-1/3">
                <div
                    class="absolute bottom-0 left-0 right-0 top-0 h-full w-full overflow-hidden bg-amber-200 bg-opacity-[0.1] bg-fixed rounded-xl">
                </div>
                <p class="font-semibold text-zinc-100 text-2xl z-10">Yatırım</p>
                <p class="font-medium text-2xl text-white z-10"><i class="fa-solid fa-money-bill-transfer"></i></p>
            </li>
            <li id="withdrawal-tab" data-tabs-target="#withdrawal" type="button" role="tab" aria-controls="withdrawal"
                class="relative p-4 bg-center bg-cover bg-[url('https://tailwindcss.com/_next/static/media/docs@tinypng.d9e4dcdc.png')] 
                rounded-xl flex flex-col gap-y-2 basis-1/3">
                <div
                    class="absolute bottom-0 left-0 right-0 top-0 h-full w-full overflow-hidden bg-amber-200 bg-opacity-[0.1] bg-fixed rounded-xl">
                </div>
                <p class="font-semibold text-zinc-100 text-2xl z-10">Çekim</p>
                <p class="font-medium text-2xl text-white z-10"><i class="fa-solid fa-hand-holding-dollar"></i></p>
            </li>
        </ul>
        <div id="default-tab-content bg-black">
            <div class="hidden p-4 rounded-lg !border !border-2 !border-zinc-700" id="profile" role="tabpanel"
                aria-labelledby="profile-tab">
                <div class="relative overflow-x-auto">
                    <p class="text-white font-bold mb-2">Taleplerim</p>
                    <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
                        <thead class="text-xs text-zinc-200 bg-zinc-800 uppercase">
                            <tr>
                                <th scope="col" class="px-6 py-3">
                                    Tarih
                                </th>
                                <th scope="col" class="px-6 py-3">
                                    Miktar
                                </th>
                                <th scope="col" class="px-6 py-3">
                                    Tür
                                </th>
                                <th scope="col" class="px-6 py-3">
                                    Durum
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for trans in transactions %}
                            <tr class="border-b border-zinc-600 text-white">
                                <th scope="row"
                                    class="px-6 py-4 font-medium text-white whitespace-nowrap dark:text-white">
                                    {{trans.created_at}}
                                </th>
                                <td class="px-6 py-4">
                                    {{trans.amount}}
                                </td>
                                <td class="px-6 py-4">
                                    {{trans.type}}
                                </td>
                                <td class="px-6 py-4">
                                    {{trans.status}}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="hidden p-4 rounded-lg !border !border-2 !border-zinc-700" id="deposit" role="tabpanel"
                aria-labelledby="deposit-tab">

                <form class="max-w-sm mx-auto" method="POST" id="deposit-form">
                    {% csrf_token %}
                    <div class="mb-5">
                        <label for="email" class="block mb-1 text-lg font-medium text-zinc-200">TRC20 Adresimiz
                        </label>
                        <p class="text-zinc-100">TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t
                            <i class="fa-regular fa-copy fill-amber-500 ml-2"></i>
                        </p>
                    </div>
                    <div class="mb-5">
                        <label for="email" class="block mb-1 text-lg font-medium text-zinc-200">TRC20 adresiniz
                        </label>
                        <input type="text" id="trc20" name="trc20"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700"
                            required />
                    </div>
                    <div class="mb-5">
                        <label for="amount" class="block mb-2 text-sm font-medium text-white">Miktar</label>
                        <input type="text" id="amount" name="amount"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700"
                            required />
                    </div>
                    <button type="submit"
                        class="text-white bg-green-500  font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center">Gönder</button>
                </form>
                <div class="success text-center mt-8 flex flex-col" style="display: none;">
                    <span class="text-white inline-block">Talebiniz işleme alındı...Yönlendiriliyorsunuz.</span>
                    <i class="fa-solid fa-check text-7xl text-green-600"></i>
                </div>
            </div>
            <div class="hidden p-4 rounded-lg !border !border-2 !border-zinc-700" id="withdrawal" role="tabpanel"
                aria-labelledby="withdrawal-tab">
                <form class="max-w-sm mx-auto" method="POST" id="withdrawal-form">
                    {% csrf_token %}
                    <div class="mb-5">
                        <label for="trc20" class="block mb-2 text-sm font-medium text-white">TRC20 Adresiniz</label>
                        <input type="text" id="trc20" name="trc20"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700"
                            required />
                    </div>
                    <div class="mb-5">
                        <label for="amount" class="block mb-2 text-sm font-medium text-white">Miktar</label>
                        <input type="text" id="amount" name="amount"
                            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700"
                            required />
                    </div>
                    <button type="submit"
                        class="text-white bg-green-500  font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center">Gönder</button>
                </form>
                <div class="success text-center mt-8 flex flex-col" style="display: none;">
                    <span class="text-white inline-block">Talebiniz işleme alındı...Yönlendiriliyorsunuz.</span>
                    <i class="fa-solid fa-check text-7xl text-green-600"></i>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    let DEPOSIT_EXCHANGE_URL = "{% url 'deposit' %}"
    $("#deposit-form").on("submit", function (event) {
        event.preventDefault()

        $.ajax({
            url: DEPOSIT_EXCHANGE_URL,
            type: 'POST',
            data: $(this).serialize(),
            success: function (d) {
                $('#deposit .success').show()
                setTimeout(function () {
                    window.location.href = window.location
                }, 3000);
            }
        });
    })

    let WITHDRAWAL_EXCHANGE_URL = "{% url 'withdrawal' %}"
    $("#withdrawal-form").on("submit", function (event) {
        event.preventDefault()

        $.ajax({
            url: WITHDRAWAL_EXCHANGE_URL,
            type: 'POST',
            data: $(this).serialize(),
            success: function (d) {
                $('#withdrawal .success').show()
                setTimeout(function () {
                    window.location.href = window.location
                }, 3000);
            }
        });
    })
</script>

{% endblock %}